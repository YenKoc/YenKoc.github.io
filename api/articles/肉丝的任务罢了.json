{"title":"肉丝的任务罢了","uid":"ab7fd6f31dafc73ffe830b8abfe31bb7","slug":"肉丝的任务罢了","date":"2021-04-25T14:03:22.000Z","updated":"2021-04-25T15:39:54.323Z","comments":true,"path":"api/articles/肉丝的任务罢了.json","keywords":null,"cover":"https://w.wallhaven.cc/full/dp/wallhaven-dpgk5o.jpg","content":"<h1 id=\"第一道题\"><a href=\"#第一道题\" class=\"headerlink\" title=\"第一道题\"></a>第一道题</h1><p><img src=\"https://raw.githubusercontent.com/YenKoc/YenKoc_tuchuang/main/images20210425220626.png\"></p>\n<p>逻辑很简单，就是输入一个username，然后经过一个native函数，和字符串做对比</p>\n<p><img src=\"https://raw.githubusercontent.com/YenKoc/YenKoc_tuchuang/main/images20210425220912.png\"></p>\n<p>调用了一个base64，</p>\n<p><img src=\"https://raw.githubusercontent.com/YenKoc/YenKoc_tuchuang/main/images20210425221140.png\"></p>\n<h1 id=\"第二题\"><a href=\"#第二题\" class=\"headerlink\" title=\"第二题\"></a>第二题</h1><p>和第一题java层逻辑差不多，稍微复杂一点，大概就是数字先md5加密，然后原数字经过一个aes-cbc加密，和md5加密后的进行拼接，进行一波对比。cbc的加密逻辑看了挺久，我以为有魔改，看了下逻辑并没有，直接hook下函数，把key和iv dump下来，解密就完事了</p>\n<p><img src=\"https://raw.githubusercontent.com/YenKoc/YenKoc_tuchuang/main/images20210425232904.png\"></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">function aa()&#123;\n    var moudle&#x3D;Process.findModuleByName(&quot;libroysue.so&quot;);\n    var hoofunc&#x3D;ptr(moudle.base).add(0x341e8);\n    Interceptor.attach(hoofunc,&#123;\n        onEnter:function(args)&#123;\n            console.log(&quot;key:&quot;,Memory.readPointer(ptr(args[3]),16));\n            console.log(&quot;content:&quot;,Memory.readCString(args[3]),16);\n            console.log(&quot;iv:&quot;,Memory.readCString(args[4]));\n\n        &#125;,onLeave:function(retval)\n        &#123;\n\n\n        &#125;\n    &#125;)\n&#125;\nsetImmediate(aa);\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h1 id=\"第三题\"><a href=\"#第三题\" class=\"headerlink\" title=\"第三题\"></a>第三题</h1><p>和第二题一样的逻辑，只是加了一些反调试，不过确实太鸡肋了，这波我静态就能搞了，甚至三个函数全nop重打包，一个是检测调试去的，看traceid，一个是看手机型号，一个是检测aosp，hh，frida一把梭也可以。</p>\n<p><img src=\"https://raw.githubusercontent.com/YenKoc/YenKoc_tuchuang/main/images20210425233916.png\"></p>\n<p>其他确实没啥好说的，强度不够高，算法不够复杂</p>\n","feature":null,"text":"第一道题 逻辑很简单，就是输入一个username，然后经过一个native函数，和字符串做对比 调用了一个base64， 第二题和第一题java层逻辑差不多，稍微复杂一点，大概就是数字先md5加密，然后原数字经过一个aes-cbc加密，和md5加密后的进行拼接，进行一波对比。c...","link":"","photos":[],"count_time":{"symbolsCount":895,"symbolsTime":"1 mins."},"categories":[{"name":"writeup","slug":"writeup","count":8,"path":"api/categories/writeup.json"}],"tags":[{"name":"reverse","slug":"reverse","count":22,"path":"api/tags/reverse.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%80%E9%81%93%E9%A2%98\"><span class=\"toc-text\">第一道题</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%BA%8C%E9%A2%98\"><span class=\"toc-text\">第二题</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%89%E9%A2%98\"><span class=\"toc-text\">第三题</span></a></li></ol>","author":{"name":"YenKoc","avatar":"https://avatars.githubusercontent.com/u/52554268?s=400&u=e21e2b4ac372eaf3c2bc9c720c1ac24f974e936a&v=4","link":""},"mapped":true,"prev_post":{"title":"ISCC某安卓题","uid":"b380b394179f19e6fa4ccc3b184ec926","slug":"ISCC某安卓题","date":"2021-05-02T11:56:33.000Z","updated":"2021-05-02T12:16:04.086Z","comments":true,"path":"api/articles/ISCC某安卓题.json","keywords":null,"cover":"https://w.wallhaven.cc/full/28/wallhaven-281d5y.png","text":"口述下:ctf的安卓题，不能以实战的角度去逆了，毕竟从ctf角度出发，我们需要的是最短时间拿到flag，而不是把整体app代码全部分析出来，昨晚睡前，大概看了下文件就睡了，早上把逻辑理了下，就开始了，首先是java2c，这个问题，其实就是和java层的代码一样，不过是写在ndk中...","link":"","photos":[],"count_time":{"symbolsCount":"3k","symbolsTime":"3 mins."},"categories":[{"name":"writeup","slug":"writeup","count":8,"path":"api/categories/writeup.json"}],"tags":[{"name":"reverse","slug":"reverse","count":22,"path":"api/tags/reverse.json"}],"author":{"name":"YenKoc","avatar":"https://avatars.githubusercontent.com/u/52554268?s=400&u=e21e2b4ac372eaf3c2bc9c720c1ac24f974e936a&v=4","link":""}},"next_post":{"title":"2021HW的个人总结","uid":"92105b8d45b62e5c37b36b7d4a309a89","slug":"2021HW的个人总结","date":"2021-04-22T17:50:06.000Z","updated":"2021-04-25T02:00:53.648Z","comments":true,"path":"api/articles/2021HW的个人总结.json","keywords":null,"cover":"https://w.wallhaven.cc/full/rd/wallhaven-rd3pjw.jpg","text":"1.hw给我带来什么？​ 首先，我今年能来护网真的算是我的运气了，至于为什么这么说，因为在面试这个部门的过程中，其实遇到了一些插曲，在一面的时候，回答的还算完美，之前跟着樱花师傅写的os和csapp lab还是有印象的，在二面的时候，就开始崩了，问了很多安卓开发的问题，然而我这里...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"总结","slug":"总结","count":1,"path":"api/categories/总结.json"}],"tags":[{"name":"总结","slug":"总结","count":1,"path":"api/tags/总结.json"}],"author":{"name":"YenKoc","avatar":"https://avatars.githubusercontent.com/u/52554268?s=400&u=e21e2b4ac372eaf3c2bc9c720c1ac24f974e936a&v=4","link":""}}}